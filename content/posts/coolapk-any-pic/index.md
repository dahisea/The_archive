---
title: "分析一個兩年前發現的酷安社區漏洞，無視圖片連結域限制發帖"
date: 2025-06-04T09:25:04Z
draft: false
description: "無視圖片連結域限制發帖"
tags: ["coolapk", "bug"]
---

## 發帖原因
起因是我昨天在L站發帖發現引用我的圖床出錯了（我全站有反機器人規則）。 然後突然想起來了這個酷安漏洞，**不知道**現在還有沒有。

由於本人之前一直活躍於水深火熱，對官方烏煙瘴氣的酷安社區，而酷安因為我使用外掛程式以及利用（沒幹壞事）這個漏洞把我所有帳號與設備全部封禁。

但是他們修復bug好像修錯了（我當時用這個漏洞給酷安帖子直接引用了酷安的OSS物件存儲，然後我發現沒有防盜鏈，閑著沒事直接當博客的同步圖床使了... 主要是我覺得同步圖片挺麻煩的）。

本人態度詳見**結語**。

我無法直接與酷安官方取得聯繫，所以我打算公開一下。

內容具體表現概括為：一種通過**酷安302跳轉api**的繞過域名校驗的圖片引用方法

## 複現方法：
1.發佈任意帶圖片的動態
2.使用抓包軟體，去酷安編輯動態並抓包，找到圖片部分，使用以下連結302API（我想不出為什麼要設置成302，太不安全了）替換圖片連結：

```
https://coolapk.com/link?url=[圖片的完整連結（URL）]
```

3.成功發佈並引用外部圖片
4.等待**號沒**

## 分析和啟示
酷安的防外鏈設置為『*.coolapk.com』，而外鏈API是使用了302代碼，且對站外鏈接處理不當。 沒有處理OSS敏感機密。

我們在外鏈跳轉時應該使用嚴格的匹配，不隨意302外鏈內容。 我們的物件存儲防盜鏈不應該設置為空，反代OSS時處理OSS桶的機密內容。 我們的軟體中的外鏈引用限制要保持最小化（避免泛功能變數名稱這種的白名單）。

### 結語
我酷安號沒了，不知道酷安**是否**修復了此漏洞
不建議去拿大號試，也不要在自己登錄過帳號的設備試，我**不知道**我的酷安賬號為什麼被封，是盜鏈酷安當圖床導致可能的被他人攻擊還是用外掛程式之類的什麼原因，也**不知道**酷安會不會追究法律責任。 這隻是一個漏洞，本人不是酷安程式師，也沒法對此漏洞進行修復。 本人為濫用酷安外鏈的行為**抱歉**，並且在帳號被封后已經**註銷**酷安帳號（無法聯繫到酷安管理員，酷安管理員不回我消息）。 本人不對在酷安的行為負任何法律責任。 本文僅為感想與技術交流用途，嚴禁惡意運用此Bug。

本帖首先在linux do發佈